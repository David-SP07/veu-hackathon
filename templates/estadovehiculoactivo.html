<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - VEU</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <!-- Leaflet.js CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>

<body>
    <header>
        <div class="header">
            <img id="logo" src="static/veuLogo.png" alt="">
        </div>
    </header>

    <main>
        <!-- Imagen de la unidad -->
        <div id="unidad-img-container">
            <img id="unidad-img" src="static/unidad.png" alt="Vehículo" />
        </div>

        <div id="estado-barra">
            <div id="verde" class="alerta"></div>  <!-- Flecha verde -->
            <div id="amarillo" class="alerta"></div> <!-- Flecha amarilla -->
            <div id="rojo" class="alerta"></div>    <!-- Flecha roja -->
        </div>

        <!-- Información de la unidad -->
        <div class="unidad-info">
            <h2 id="unidad-nombre">Unidad VEU Lite 01</h2>
            <p id="centro-nombre">Centro Iztapalapa I</p>
            <p id="placa">DB4ST1 | LITE1.0 | 2023</p>
            <p id="ultimo-mantenimiento">Último mantenimiento: 01/01/2025</p>

            <!-- Barra de estado (Semáforo) -->
            <div id="estado-barra">
                <div id="verde" class="alerta"></div>  <!-- Flecha verde -->
                <div id="amarillo" class="alerta"></div> <!-- Flecha amarilla -->
                <div id="rojo" class="alerta"></div>    <!-- Flecha roja -->
            </div>
        </div>

        <!-- Horarios del turno -->
        <div class="turnos">
            <button id="turnoI" class="turno-btn">15:30</button>
            <button id="turnoD" class="turno-btn">17:30</button>
        </div>

        <!-- Botones de asistencia -->
        <div class="asistencia">
            <button class="asistencia-btn">Asistencia Mecánica</button>
            <button class="asistencia-btn">Asistencia Vial</button>
        </div>
        
    </main>

    <footer>
        <div class="footer-nav">
            <button onclick="location.href='/mi-perfil'">
                <svg width="25px" height="25px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#ffffff" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>profile_round [#1346]</title> <desc>Created with Sketch.</desc> <defs> </defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Dribbble-Light-Preview" transform="translate(-380.000000, -2119.000000)" fill="#fff"> <g id="icons" transform="translate(56.000000, 160.000000)"> <path d="M338.083123,1964.99998 C338.083123,1962.79398 336.251842,1960.99998 334,1960.99998 C331.748158,1960.99998 329.916877,1962.79398 329.916877,1964.99998 C329.916877,1967.20599 331.748158,1968.99999 334,1968.99999 C336.251842,1968.99999 338.083123,1967.20599 338.083123,1964.99998 M341.945758,1979 L340.124685,1979 C339.561214,1979 339.103904,1978.552 339.103904,1978 C339.103904,1977.448 339.561214,1977 340.124685,1977 L340.5626,1977 C341.26898,1977 341.790599,1976.303 341.523154,1975.662 C340.286989,1972.69799 337.383888,1970.99999 334,1970.99999 C330.616112,1970.99999 327.713011,1972.69799 326.476846,1975.662 C326.209401,1976.303 326.73102,1977 327.4374,1977 L327.875315,1977 C328.438786,1977 328.896096,1977.448 328.896096,1978 C328.896096,1978.552 328.438786,1979 327.875315,1979 L326.054242,1979 C324.778266,1979 323.773818,1977.857 324.044325,1976.636 C324.787453,1973.27699 327.107688,1970.79799 330.163906,1969.67299 C328.769519,1968.57399 327.875315,1966.88999 327.875315,1964.99998 C327.875315,1961.44898 331.023403,1958.61898 334.733941,1959.04198 C337.422678,1959.34798 339.650022,1961.44698 340.05323,1964.06998 C340.400296,1966.33099 339.456073,1968.39599 337.836094,1969.67299 C340.892312,1970.79799 343.212547,1973.27699 343.955675,1976.636 C344.226182,1977.857 343.221734,1979 341.945758,1979 M337.062342,1978 C337.062342,1978.552 336.605033,1979 336.041562,1979 L331.958438,1979 C331.394967,1979 330.937658,1978.552 330.937658,1978 C330.937658,1977.448 331.394967,1977 331.958438,1977 L336.041562,1977 C336.605033,1977 337.062342,1977.448 337.062342,1978" id="profile_round-[#1346]"> </path> </g> </g> </g> </g></svg>
            </button>
            <button onclick="location.href='/mis-turnos'">
                <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 9H21M7 3V5M17 3V5M6 13H8M6 17H8M11 13H13M11 17H13M16 13H18M16 17H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </button>
            <button onclick="location.href='/dashboard'">
                <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12 21C15.5 17.4 19 14.1764 19 10.2C19 6.22355 15.866 3 12 3C8.13401 3 5 6.22355 5 10.2C5 14.1764 8.5 17.4 12 21Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 13C13.6569 13 15 11.6569 15 10C15 8.34315 13.6569 7 12 7C10.3431 7 9 8.34315 9 10C9 11.6569 10.3431 13 12 13Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </button>
            <button onclick="location.href='/estado-vehiculo'">
                <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M8 17H16M8 17C8 18.1046 7.10457 19 6 19C4.89543 19 4 18.1046 4 17M8 17C8 15.8954 7.10457 15 6 15C4.89543 15 4 15.8954 4 17M16 17C16 18.1046 16.8954 19 18 19C19.1046 19 20 18.1046 20 17M16 17C16 15.8954 16.8954 15 18 15C19.1046 15 20 15.8954 20 17M10 5V11M4 11L4.33152 9.01088C4.56901 7.58593 4.68776 6.87345 5.0433 6.3388C5.35671 5.8675 5.79705 5.49447 6.31346 5.26281C6.8993 5 7.6216 5 9.06621 5H12.4311C13.3703 5 13.8399 5 14.2662 5.12945C14.6436 5.24406 14.9946 5.43194 15.2993 5.68236C15.6435 5.96523 15.904 6.35597 16.425 7.13744L19 11M4 17H3.6C3.03995 17 2.75992 17 2.54601 16.891C2.35785 16.7951 2.20487 16.6422 2.10899 16.454C2 16.2401 2 15.9601 2 15.4V14.2C2 13.0799 2 12.5198 2.21799 12.092C2.40973 11.7157 2.71569 11.4097 3.09202 11.218C3.51984 11 4.0799 11 5.2 11H17.2C17.9432 11 18.3148 11 18.6257 11.0492C20.3373 11.3203 21.6797 12.6627 21.9508 14.3743C22 14.6852 22 15.0568 22 15.8C22 15.9858 22 16.0787 21.9877 16.1564C21.9199 16.5843 21.5843 16.9199 21.1564 16.9877C21.0787 17 20.9858 17 20.8 17H20" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </button>
            <button onclick="location.href='/logout'">
                <svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M18 8L22 12M22 12L18 16M22 12H9M15 4.20404C13.7252 3.43827 12.2452 3 10.6667 3C5.8802 3 2 7.02944 2 12C2 16.9706 5.8802 21 10.6667 21C12.2452 21 13.7252 20.5617 15 19.796" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </button>
        </div>
    </footer>

    <script src="/static/js/dashboard.js"></script>
    <script>
        // Obtener los datos del vehículo desde la API backend
        fetch('/api/vehiculo_reservado')
            .then(response => response.json())
            .then(data => {
                if (data.mensaje === "No hay vehículo reservado en este momento.") {
                    document.getElementById('unidad-img-container').innerHTML = '<p>No tienes un vehículo reservado.</p>';
                    // Si no hay vehículo reservado, mostrar los botones de reserva
                    document.getElementById('unidad-nombre').textContent = 'No hay vehículo';
                    document.getElementById('centro-nombre').textContent = 'N/A';
                    document.getElementById('placa').textContent = 'N/A';
                    document.getElementById('modelo').textContent = 'N/A';
                    document.getElementById('ano').textContent = 'N/A';
                    document.getElementById('ultimo-mantenimiento').textContent = 'N/A';
                } else {
                    // Si hay un vehículo reservado, actualizar la información
                    document.getElementById('unidad-nombre').textContent = data.nombre;
                    document.getElementById('centro-nombre').textContent = data.centro;
                    document.getElementById('placa').textContent = data.placa;
                    document.getElementById('modelo').textContent = data.modelo;
                    document.getElementById('ano').textContent = data.ano;
                    document.getElementById('ultimo-mantenimiento').textContent = data.mantenimiento;

                    // Lógica de las alertas de mantenimiento
                    if (data.mantenimiento === "En mantenimiento") {
                        document.getElementById('rojo').style.display = 'block';
                        document.getElementById('verde').style.display = 'none';
                        document.getElementById('amarillo').style.display = 'none';
                    } else if (data.mantenimiento === "En buenas condiciones") {
                        document.getElementById('verde').style.display = 'block';
                        document.getElementById('rojo').style.display = 'none';
                        document.getElementById('amarillo').style.display = 'none';
                    } else {
                        document.getElementById('amarillo').style.display = 'block';
                        document.getElementById('verde').style.display = 'none';
                        document.getElementById('rojo').style.display = 'none';
                    }
                }
            })
            .catch(error => console.log('Error:', error));
    </script>
</body>

</html>